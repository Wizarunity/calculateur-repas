<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculateur de repas</title>

<style>
body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
    background-color: #E9ECF2;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.app {
    background-color: #E9ECF2;
    width: 100%;
    max-width: 390px;
    padding: 25px;
    box-sizing: border-box;
    position: relative;
}

h1 {
    text-align: center;
    color: #444;
    margin-bottom: 25px;
}

label {
    display: block;
    margin-top: 15px;
    color: #555;
    font-size: 15px;
}

input {
    width: 100%;
    padding: 14px;
    margin-top: 5px;
    border-radius: 14px;
    border: none;
    font-size: 18px;
    box-sizing: border-box;
}

.buttons {
    display: flex;
    gap: 15px;
    margin-top: 30px;
}

button {
    flex: 1;
    padding: 14px;
    border-radius: 18px;
    border: none;
    font-size: 18px;
    cursor: pointer;
}

.calcul { background-color: #A8D5BA; }
.reset { background-color: #F4B6C2; }

/* Bouton engrenage */
.settings-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    font-size: 22px;
    cursor: pointer;
}

/* Page paramètres */
.settings {
    display: none;
}
</style>
</head>

<body>

<div class="app">

    <!-- Bouton paramètres -->
    <div class="settings-btn" onclick="ouvrirParametres()">⚙️</div>

    <!-- Page calcul -->
    <div id="pageCalcul">
        <h1>Calculateur de repas</h1>

        <label>Poids des légumes (g)</label>
        <input id="legumes" type="number">

        <label>Poids des féculents (g)</label>
        <input id="feculents" type="number">

        <label>Poids total (g)</label>
        <input id="total" type="number">

        <div class="buttons">
            <button class="calcul" onclick="calculer()">Calcul</button>
            <button class="reset" onclick="resetChamps()">Reset</button>
        </div>
    </div>

    <!-- Page paramètres -->
    <div id="pageParametres" class="settings">
        <h1>Paramétrage</h1>

        <label>Pourcentage légumes (%)</label>
        <input id="pctLegumes" type="number" value="75" oninput="syncPourcentages('legumes')">

        <label>Pourcentage féculents (%)</label>
        <input id="pctFeculents" type="number" value="25" oninput="syncPourcentages('feculents')">

        <div class="buttons">
            <button class="calcul" onclick="fermerParametres()">Valider</button>
        </div>
    </div>

</div>

<script>
let pctLegumes = 0.75;
let pctFeculents = 0.25;

function ouvrirParametres() {
    document.getElementById("pageCalcul").style.display = "none";
    document.getElementById("pageParametres").style.display = "block";
}

function fermerParametres() {
    pctLegumes = document.getElementById("pctLegumes").value / 100;
    pctFeculents = document.getElementById("pctFeculents").value / 100;

    document.getElementById("pageParametres").style.display = "none";
    document.getElementById("pageCalcul").style.display = "block";
}

function syncPourcentages(changed) {
    let leg = document.getElementById("pctLegumes");
    let fec = document.getElementById("pctFeculents");

    if (changed === "legumes") {
        leg.value = Math.min(100, Math.max(0, leg.value));
        fec.value = 100 - leg.value;
    } else {
        fec.value = Math.min(100, Math.max(0, fec.value));
        leg.value = 100 - fec.value;
    }
}

function calculer() {
    let legumes = document.getElementById("legumes").value;
    let feculents = document.getElementById("feculents").value;
    let total = document.getElementById("total").value;

    if (legumes) {
        legumes = parseFloat(legumes);
        total = legumes / pctLegumes;
        feculents = total * pctFeculents;
    } 
    else if (feculents) {
        feculents = parseFloat(feculents);
        total = feculents / pctFeculents;
        legumes = total * pctLegumes;
    } 
    else if (total) {
        total = parseFloat(total);
        legumes = total * pctLegumes;
        feculents = total * pctFeculents;
    } 
    else return;

    document.getElementById("legumes").value = Math.round(legumes);
    document.getElementById("feculents").value = Math.round(feculents);
    document.getElementById("total").value = Math.round(total);
}

function resetChamps() {
    document.getElementById("legumes").value = "";
    document.getElementById("feculents").value = "";
    document.getElementById("total").value = "";
}
</script>

</body>
</html>
